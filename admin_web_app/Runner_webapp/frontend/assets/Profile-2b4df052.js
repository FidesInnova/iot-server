import{ac as I,r as u,a as D,u as E,j as e,a6 as R,w as G,x as L}from"./index-f1a5ff0b.js";import{I as h}from"./Input-f96f5d40.js";import{A as y}from"./index-87490377.js";import{U as z}from"./Upload-c97b599f.js";import{B as F}from"./Button-afcfcbb1.js";import{t as T,N as B}from"./toast-a2d3b2a8.js";import{F as M}from"./FormItem-abebf158.js";import{F as $}from"./FormDesription-1859982e.js";import{F as p}from"./FormRow-a5d47e2c.js";import{c as H,d as c,F as J,a as q,b as d}from"./index.esm-c80e5c03.js";import{a1 as S,a2 as O,I as _,a3 as K,d as V}from"./index.esm-699c5401.js";import{a as X,e as Z}from"./UserApi-23221c36.js";import"./Card-d39e23a6.js";import"./Badge-93ce6042.js";import"./RichTextEditor-84be8b19.js";import"./Skeleton-f6c4cf8c.js";import"./Views-545588fb.js";import"./react-tooltip.min-0e1c37db.js";import"./ServiceAPI-60d60c3c.js";import"./SegmentItemOption-eeadaa43.js";import"./SvgIcon-82ce3cf9.js";import"./context-07f85daf.js";import"./isNil-439bb3ad.js";import"./get-9c300d8d.js";import"./_MapCache-be4b2d97.js";import"./motion-bbaf39fb.js";import"./usePopper-1dbffb61.js";import"./warning-31bbcec2.js";import"./index-fd7e9c30.js";import"./cloneDeep-8806e7e3.js";import"./_getPrototype-4a7ee280.js";import"./CloseButton-4410af22.js";import"./StatusIcon-7c22de5b.js";import"./chainedFunction-070f832c.js";import"./index-28f98aac.js";import"./Select-894eed33.js";import"./index-56c156a2.js";import"./index-ff5affb8.js";import"./Tag-85d8db80.js";import"./index-3bc265bb.js";import"./useThemeClass-a2b8f01d.js";function W(l){const x=document.cookie.split(";").map(m=>m.trim());for(const m of x){const[j,N]=m.split("=");if(j===l)return decodeURIComponent(N)}return null}const Q=W("accessToken");async function Y(l,g){return I.fetchData({url:`https://developer.fidesinnova.io/app/v1/media/upload?type=${l}`,method:"post",headers:{Authorization:`Bearer ${Q}`},data:g})}const ee=H().shape({firstName:c().min(0,"Too Short!").max(20,"Too Long!"),lastName:c().min(0,"Too Short!").max(20,"Too Long!"),email:c().email("Invalid email").required("Email Required"),mobile:c(),walletAddress:c(),avatar:c()}),He=({})=>{const[l,g]=u.useState({}),[x,m]=u.useState(""),[j,N]=u.useState(""),[A,P]=u.useState(!0),w=D();u.useEffect(()=>{async function t(){const a=await X();g(a.data.data),m(a.data.data.avatar),P(!1)}t()},[]);const{_id:b}=E(t=>t.auth.user),k=async(t,a)=>{var n,i,r,s;console.log("values",t);const f=new FormData;f.append("file",j);const o=j?await Y("profile",f):"";w(G(((i=(n=o==null?void 0:o.data)==null?void 0:n.data)==null?void 0:i.url)||l.avatar)),w(L(t.firstName)),Z((b==null?void 0:b.toString())||"",{...t,avatar:((s=(r=o==null?void 0:o.data)==null?void 0:r.data)==null?void 0:s.url)||l.avatar}),T.push(e.jsx(B,{title:"Profile updated",type:"success"}),{placement:"top-center"}),a(!1)},C=t=>{const a=t.target.files[0];if(a&&(a.type==="image/png"||a.type==="image/jpeg"||a.type==="image/jpg")){if(a.size>512e3){alert("Please upload a file smaller than 500KB.");return}const o=new FileReader;o.onload=n=>{var i;if((i=n.target)!=null&&i.result){const r=n.target.result,s=new Image;s.src=r,s.onload=()=>{const v=s.width,U=s.height;v<=200&&U<=200?(N(a),m(r)):alert("Please upload a valid image file with dimensions 200 x 200 pixels.")}}},o.readAsDataURL(a)}else alert("Please upload a valid ( PNG, JPEG, JPG ) file.")};return e.jsx(J,{enableReinitialize:!0,initialValues:l,validationSchema:ee,onSubmit:(t,{setSubmitting:a})=>{a(!0),setTimeout(()=>{k(t,a)},1e3)},children:({values:t,touched:a,errors:f,isSubmitting:o,resetForm:n})=>{const i={touched:a,errors:f};return e.jsx(q,{children:A===!1&&e.jsxs(M,{children:[e.jsx($,{title:"General",desc:"Basic info, like your name and address that will displayed in public"}),e.jsx(p,{name:"firstName",label:"First Name",...i,children:e.jsx(d,{type:"text",autoComplete:"off",name:"firstName",placeholder:"first name",component:h,prefix:e.jsx(S,{className:"text-xl"})})}),e.jsx(p,{name:"lastName",label:"Last Name",...i,children:e.jsx(d,{type:"text",autoComplete:"off",name:"lastName",placeholder:"last name",component:h,prefix:e.jsx(S,{className:"text-xl"})})}),e.jsx(p,{name:"email",label:"Email",...i,children:e.jsx(d,{type:"email",autoComplete:"off",name:"email",placeholder:"Email",component:h,prefix:e.jsx(O,{className:"text-xl"})})}),e.jsx(p,{name:"mobile",label:"Mobile",...i,children:e.jsx(d,{type:"text",autoComplete:"off",name:"mobile",placeholder:"mobile",component:h,prefix:e.jsx(_,{className:"text-xl"})})}),e.jsx(p,{name:"walletAddress",label:"Wallet Address",...i,children:e.jsx(d,{type:"text",autoComplete:"off",name:"walletAddress",placeholder:"wallet address",component:h,prefix:e.jsx(K,{className:"text-xl"})})}),e.jsx(p,{name:"avatar",label:"Avatar",...i,children:e.jsxs("div",{className:`flex w-full items-center ${x&&"justify-around"||"gap-10"}`,children:[e.jsx(d,{name:"serviceImage",children:({field:r,form:s})=>{const v=r.value?{src:r.value}:{};return e.jsx(z,{className:"cursor-pointer",showList:!1,uploadLimit:1,accept:".png, .jpg, .jpeg",onChange:C,children:!x&&e.jsx(y,{className:"border-2 border-white dark:border-gray-800 shadow-lg",size:60,shape:"circle",icon:e.jsx(V,{}),...v})||e.jsx(y,{className:"!w-[100px] !h-[100px] overflow-hidden border-2 border-white dark:border-gray-800 shadow-lg",size:60,shape:"circle",icon:e.jsx("img",{src:x,alt:"Uploaded Service Image",style:{objectFit:"cover",width:"100px !important",height:"100px !important"}}),...v})})}}),e.jsxs("p",{children:[e.jsx("strong",{children:"Image Upload Requirements:"}),e.jsx("br",{}),e.jsx("strong",{children:"Format:"})," PNG, JPEG, JPG ",e.jsx("br",{}),e.jsx("strong",{children:"Size:"})," 200x200 pixels Maximum",e.jsx("br",{}),e.jsx("strong",{children:"File size:"})," 500 KB"]})]})}),e.jsxs("div",{className:"mt-4 ltr:text-right",children:[e.jsx(F,{className:"ltr:mr-2 rtl:ml-2",type:"button",onClick:()=>n(),children:"Reset"}),e.jsx(F,{variant:"solid",loading:o,type:"submit",children:o?"Updating":"Update"})]})]})||e.jsx("div",{className:"w-full h-[60dvh]",children:e.jsx(R,{loading:!0})})})}})};export{He as default};
