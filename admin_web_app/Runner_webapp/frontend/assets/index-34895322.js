import{r as u,j as e,a6 as Y}from"./index-f1a5ff0b.js";import{F as v,a as M,b as p,c as L,d as C}from"./index.esm-c80e5c03.js";import{I as j}from"./Input-f96f5d40.js";import{B as g}from"./Button-afcfcbb1.js";import{F as $}from"./FormItem-abebf158.js";import{F as x}from"./FormRow-a5d47e2c.js";import{b as _,c as z,d as G,e as q}from"./NotificationService-cc038790.js";import"./Alert-3f64b1b7.js";import"./index-87490377.js";import"./Badge-93ce6042.js";import{D as F}from"./index-995b9d48.js";import"./Card-d39e23a6.js";import"./index-56c156a2.js";import{D as A}from"./Skeleton-f6c4cf8c.js";import"./index-443dcd01.js";import"./index-54792e3d.js";import"./index-a40ab2e0.js";import"./index-e038d582.js";import{t as E,N as P}from"./toast-a2d3b2a8.js";import"./index-8424e2af.js";import"./ScrollBar-f45e915f.js";import"./index-3e2b7b09.js";import"./Select-894eed33.js";import"./index-28f98aac.js";import"./index-5a7a16fd.js";import"./Tag-85d8db80.js";import"./index-c04c0422.js";import"./Upload-c97b599f.js";import"./RichTextEditor-84be8b19.js";import{A as J,B as K,C as Q,z as W}from"./index.esm-699c5401.js";import"./Views-545588fb.js";import"./react-tooltip.min-0e1c37db.js";import"./ServiceAPI-60d60c3c.js";import"./SegmentItemOption-eeadaa43.js";import"./SvgIcon-82ce3cf9.js";import"./context-07f85daf.js";import"./isNil-439bb3ad.js";import"./get-9c300d8d.js";import"./_MapCache-be4b2d97.js";import"./motion-bbaf39fb.js";import"./index-fd7e9c30.js";import"./StatusIcon-7c22de5b.js";import"./CloseButton-4410af22.js";import"./usePopper-1dbffb61.js";import"./warning-31bbcec2.js";import"./useControllableState-404b8b27.js";import"./useRootClose-02fb158e.js";import"./cloneDeep-8806e7e3.js";import"./_getPrototype-4a7ee280.js";import"./index-3bc265bb.js";import"./chainedFunction-070f832c.js";import"./index-ff5affb8.js";import"./useThemeClass-a2b8f01d.js";const X=({children:d,itemsPerPage:m=10,className:b})=>{const[r,h]=u.useState(1),i=Math.ceil(d.length/m),c=o=>{h(o)},N=()=>{r>1&&h(r-1)},y=()=>{r<i&&h(r+1)},f=()=>{const o=[];if(i<=5)for(let t=1;t<=i;t++)o.push(e.jsx("button",{onClick:()=>c(t),disabled:t===r,className:`px-2 py-1 mx-1 border text-white rounded ${t===r?"bg-gray-300 !text-black":""}`,children:t},t));else if(r<=3){for(let t=1;t<=Math.min(3,i);t++)o.push(e.jsx("button",{onClick:()=>c(t),disabled:t===r,className:`px-2 py-1 mx-1 border text-white rounded ${t===r?"bg-gray-300 !text-black":""}`,children:t},t));i>4&&(o.push(e.jsx("span",{className:"px-2 py-1 mx-1",children:"..."},"ellipsis1")),o.push(e.jsx("button",{onClick:()=>c(i-1),className:"px-2 py-1 mx-1 text-white border rounded",children:i-1},i-1)),o.push(e.jsx("button",{onClick:()=>c(i),className:"px-2 py-1 mx-1 text-white border rounded",children:i},i)))}else if(r>=i-2){o.push(e.jsx("button",{onClick:()=>c(1),className:"px-2 py-1 mx-1 text-white border rounded",children:"1"},1)),o.push(e.jsx("button",{onClick:()=>c(2),className:"px-2 py-1 mx-1 text-white border rounded",children:"2"},2)),o.push(e.jsx("span",{className:"px-2 py-1 mx-1",children:"..."},"ellipsis2"));for(let t=i-2;t<=i;t++)o.push(e.jsx("button",{onClick:()=>c(t),disabled:t===r,className:`px-2 py-1 mx-1 text-white border rounded ${t===r?"bg-gray-300 !text-black":""}`,children:t},t))}else{o.push(e.jsx("button",{onClick:()=>c(1),className:"px-2 py-1 mx-1 text-white border rounded",children:"1"},1)),o.push(e.jsx("span",{className:"px-2 py-1 mx-1",children:"..."},"ellipsis1"));for(let t=r-1;t<=r+1;t++)o.push(e.jsx("button",{onClick:()=>c(t),disabled:t===r,className:`px-2 py-1 mx-1 text-white border rounded ${t===r?"bg-gray-300 !text-black":""}`,children:t},t));o.push(e.jsx("span",{className:"px-2 py-1 mx-1",children:"..."},"ellipsis2")),o.push(e.jsx("button",{onClick:()=>c(i-1),className:"px-2 py-1 mx-1 text-white border rounded",children:i-1},i-1)),o.push(e.jsx("button",{onClick:()=>c(i),className:"px-2 py-1 mx-1 text-white border rounded",children:i},i))}return e.jsxs("div",{className:"flex justify-center mt-4",children:[e.jsx("button",{onClick:N,disabled:r===1,className:"px-2 py-1 mx-1 border rounded",children:e.jsx(J,{})}),o,e.jsx("button",{onClick:y,disabled:r===i,className:"px-2 py-1 mx-1 border rounded",children:e.jsx(K,{})})]})},S=(r-1)*m,T=d.slice(S,S+m);return e.jsxs("div",{className:"w-full",children:[e.jsx("div",{className:`${b}`,children:T}),f()]})},Z=X,ee=L().shape({title:C().required("Title is required"),message:C().required("Message is required"),userEmail:C().required("User Email is required")}),I=L().shape({title:C().required("Title is required"),message:C().required("Message is required")});function te(d){const m=new Date(d),b=m.getUTCFullYear(),r=String(m.getUTCMonth()+1).padStart(2,"0"),h=String(m.getUTCDate()).padStart(2,"0"),i=String(m.getUTCHours()).padStart(2,"0"),c=String(m.getUTCMinutes()).padStart(2,"0"),N=String(m.getUTCSeconds()).padStart(2,"0"),y=`${b}-${r}-${h}`,f=`${i}:${c}:${N}`;return`${y} , ${f}`}function tt(){const[d,m]=u.useState({}),[b,r]=u.useState(0),[h,i]=u.useState(!1),[c,N]=u.useState(0),[y,f]=u.useState(!0),[S,T]=u.useState([]),[o,t]=u.useState(!1);function k(){N(c+1)}u.useEffect(()=>{async function s(){var l;f(!0);const a=await _();T((l=a==null?void 0:a.data)==null?void 0:l.data),f(!1)}s()},[c]);async function B(s,a){await z(s.userEmail,s.title,s.message),E.push(e.jsx(P,{title:"Notification sended successfully",type:"success"}),{placement:"top-center"}),a(!1)}async function H(s,a){await G(s.title,s.message,s.expiryDate),E.push(e.jsx(P,{title:"Notification sended successfully",type:"success"}),{placement:"top-center"}),k(),a(!1)}async function R(s,a){await q(d._id,s.title,s.message,U(new Date(d.expiryDate))),E.push(e.jsx(P,{title:"Notification edited successfully",type:"success"}),{placement:"top-center"}),a(!1),i(!1),k()}function U(s){const a=new Date(s),l=new Date,n=a.getTime()-l.getTime(),D=Math.floor(n/(1e3*60*60*24))+1;return m(w=>({...w,expiryDate:a})),D}function V(s){const a=new Date(s),l=new Date,n=a.getTime()-l.getTime(),D=Math.floor(n/(1e3*60*60*24))+1;r(D)}async function O(){t(!1),f(!0),await q(d._id,d.title,d.message,-1),E.push(e.jsx(P,{title:"Notification deleted successfully",type:"success"}),{placement:"top-center"}),i(!1),k()}return e.jsxs("main",{className:"w-full min-h-[70dvh] flex flex-col gap-20",children:[e.jsxs("section",{className:"flex gap-4 w-full",children:[e.jsx("div",{className:"w-1/2 border-4 rounded-xl p-6 border-[#374151] flex flex-col",children:e.jsx(v,{initialValues:{title:"",message:"",userEmail:""},validationSchema:ee,onSubmit:(s,{setSubmitting:a})=>{a(!0),B(s,a)},children:({isSubmitting:s,touched:a,errors:l})=>{const n={touched:a,errors:l};return e.jsx(M,{children:e.jsxs($,{children:[e.jsx("h2",{className:"mb-1",children:"Send notification to user"}),e.jsx("p",{children:"Provide the details for the notification"}),e.jsx(x,{name:"title",label:"Title",...n,children:e.jsx(p,{type:"text",autoComplete:"off",name:"title",placeholder:"Title",component:j})}),e.jsx(x,{name:"message",label:"Message",...n,children:e.jsx(p,{type:"text",autoComplete:"off",name:"message",placeholder:"Message",textArea:!0,component:j})}),e.jsx(x,{name:"userEmail",label:"User Email",...n,children:e.jsx(p,{type:"text",autoComplete:"off",name:"userEmail",placeholder:"User Email",component:j})}),e.jsx("div",{className:"flex mt-4 ltr:text-right",children:e.jsx(g,{className:"w-1/2 mx-auto",type:"submit",disabled:s,children:s?"Sending":"Send"})})]})})}})}),e.jsx("div",{className:"w-1/2 border-4 rounded-xl p-6 border-[#374151] flex flex-col",children:e.jsx(v,{initialValues:{title:"",message:"",expiryDate:b},validationSchema:I,onSubmit:(s,{setSubmitting:a})=>{a(!0),H({...s,expiryDate:b},a)},children:({isSubmitting:s,touched:a,errors:l})=>{const n={touched:a,errors:l};return e.jsx(M,{children:e.jsxs($,{children:[e.jsx("h2",{className:"mb-1",children:"Send public notification"}),e.jsx("p",{children:"Provide the details for the public notification"}),e.jsx(x,{name:"title",label:"Title",...n,children:e.jsx(p,{type:"text",autoComplete:"off",name:"title",placeholder:"Title",component:j})}),e.jsx(x,{name:"message",label:"Message",...n,children:e.jsx(p,{type:"text",autoComplete:"off",name:"message",placeholder:"Message",textArea:!0,component:j})}),e.jsx(x,{name:"expiryDate",label:"Expiry Date",...n,children:e.jsx(p,{autoComplete:"off",name:"expiryDate",placeholder:"Expiry Date",onChange:V,minDate:new Date,clearable:!1,defaultValue:new Date,component:F})}),e.jsx("div",{className:"flex mt-4 ltr:text-right",children:e.jsx(g,{className:"w-1/2 mx-auto",type:"submit",disabled:s,children:s?"Sending":"Send"})})]})})}})})]}),e.jsxs("section",{className:"w-full flex flex-col",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("h1",{className:"mb-6",children:"Public Notifications"}),e.jsx(g,{onClick:k,disabled:y,children:"Refresh"})]}),y==!0&&e.jsx(Y,{loading:!0})||e.jsx("section",{className:"w-full",children:e.jsx(Z,{className:"flex flex-col gap-4",itemsPerPage:10,children:S.map((s,a)=>e.jsxs("div",{className:"flex w-full p-4 border-4 border-[#374151] rounded-xl",children:[e.jsxs("div",{className:"flex flex-col gap-1 w-11/12",children:[e.jsx("h4",{className:"text-[1.3rem]",children:s.title}),e.jsxs("p",{className:"text-[1rem]",children:[e.jsx("strong",{children:"message:"})," ",s.message]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Expiry Date:"})," ",te(s.expiryDate)]})]}),e.jsxs("div",{className:"flex text-[1.5rem] gap-2 items-center justify-center w-1/12",children:[e.jsx(Q,{onClick:()=>{const l=new Date(s.expiryDate);l.setDate(l.getDate()-1),m(n=>({...n,...s,expiryDate:l})),i(!0)},className:"cursor-pointer"}),e.jsx(A,{isOpen:h,onClose:()=>i(!1),children:e.jsx(v,{initialValues:{title:d.title,message:d.message,expiryDate:d.expiryDate},validationSchema:I,onSubmit:(l,{setSubmitting:n})=>{n(!0),R({...l,expiryDate:d.expiryDate},n)},children:({isSubmitting:l,touched:n,errors:D})=>{const w={touched:n,errors:D};return e.jsx(M,{children:e.jsxs($,{children:[e.jsx("h2",{className:"mb-1",children:"Edit public notification"}),e.jsx(x,{name:"title",label:"Title",...w,children:e.jsx(p,{type:"text",autoComplete:"off",name:"title",placeholder:"Title",component:j})}),e.jsx(x,{name:"message",label:"Message",...w,children:e.jsx(p,{type:"text",autoComplete:"off",name:"message",placeholder:"Message",textArea:!0,component:j})}),e.jsx(x,{name:"expiryDate",label:"Expiry Date",...w,children:e.jsx(p,{autoComplete:"off",name:"expiryDate",placeholder:"Expiry Date",onChange:U,clearable:!1,defaultValue:d.expiryDate,component:F})}),e.jsx("div",{className:"flex mt-4 ltr:text-right",children:e.jsx(g,{className:"w-1/2 mx-auto",type:"submit",disabled:l,children:l?"Editing":"Edit"})})]})})}})}),e.jsx(W,{onClick:()=>{m(l=>({...l,...s})),t(!0)},className:"cursor-pointer"}),e.jsxs(A,{isOpen:o,onClose:()=>t(!1),children:[e.jsx("h3",{className:"mb-8",children:"Delete Confirm"}),e.jsx("p",{className:"text-center mb-4 text-[1.2rem]",children:"Are you sure about deleting this notification ?"}),e.jsxs("div",{className:"w-2/3 mx-auto flex justify-between",children:[e.jsx(g,{variant:"solid",color:"red",onClick:O,children:"Yes"}),e.jsx(g,{variant:"solid",color:"green",onClick:()=>t(!1),children:"No"})]})]})]})]}))})})]})]})}export{tt as default};
