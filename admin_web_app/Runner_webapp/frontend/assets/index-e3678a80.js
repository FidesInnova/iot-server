import{q as _,aI as V,r as v,j as e,u as k}from"./index-f1a5ff0b.js";import"./Alert-3f64b1b7.js";import{A as z}from"./index-87490377.js";import"./Badge-93ce6042.js";import{B as b}from"./Button-afcfcbb1.js";import"./index-995b9d48.js";import"./Card-d39e23a6.js";import"./index-56c156a2.js";import"./Skeleton-f6c4cf8c.js";import"./index-443dcd01.js";import"./index-54792e3d.js";import{F as M}from"./FormItem-abebf158.js";import{I as T}from"./Input-f96f5d40.js";import"./index-a40ab2e0.js";import"./index-e038d582.js";import{t as h,N as x}from"./toast-a2d3b2a8.js";import"./index-8424e2af.js";import"./ScrollBar-f45e915f.js";import"./index-3e2b7b09.js";import{S as R,c as B}from"./Select-894eed33.js";import"./index-28f98aac.js";import"./index-5a7a16fd.js";import"./Tag-85d8db80.js";import"./index-c04c0422.js";import{U as G}from"./Upload-c97b599f.js";import{F as g}from"./FormRow-a5d47e2c.js";import{c as O,d as u,F as $,a as H,b as f}from"./index.esm-c80e5c03.js";import{D as L,u as U}from"./index.esm-699c5401.js";import{g as q,h as K,i as X}from"./ServiceAPI-60d60c3c.js";import"./StatusIcon-7c22de5b.js";import"./CloseButton-4410af22.js";import"./motion-bbaf39fb.js";import"./usePopper-1dbffb61.js";import"./warning-31bbcec2.js";import"./index-fd7e9c30.js";import"./context-07f85daf.js";import"./useControllableState-404b8b27.js";import"./useRootClose-02fb158e.js";import"./cloneDeep-8806e7e3.js";import"./_MapCache-be4b2d97.js";import"./Views-545588fb.js";import"./_getPrototype-4a7ee280.js";import"./get-9c300d8d.js";import"./index-3bc265bb.js";import"./isNil-439bb3ad.js";import"./chainedFunction-070f832c.js";const F=[{value:"automation",label:"Automation"}],{Control:Z}=B,J=({children:m,...a})=>(a.getValue()[0],e.jsx(Z,{...a,children:m})),Q=O().shape({serviceName:u(),serviceType:u(),description:u(),serviceImage:u()}),W=({innerProps:m,label:a,isSelected:n})=>e.jsxs("div",{className:`flex items-center justify-between p-2 ${n?"bg-gray-100 dark:bg-gray-500":"hover:bg-gray-50 dark:hover:bg-gray-600"}`,...m,children:[e.jsx("div",{className:"flex items-center",children:e.jsx("span",{className:"ml-2 rtl:mr-2",children:a})}),n&&e.jsx(U,{className:"text-emerald-500 text-xl"})]}),Y=({userId:m=k(a=>a.auth.user)})=>{const a=_(),{serviceId:n}=V(),[j,E]=v.useState(!1),[p,S]=v.useState(""),[A,w]=v.useState({userId:m._id,serviceName:"",serviceType:"",description:"",serviceImage:""});v.useEffect(()=>{const i=async()=>{try{const r=await q();if(r.data){const s=r.data.data.filter(t=>t._id==n);s.length>0?(w(t=>({...t,serviceName:s[0].serviceName,serviceType:s[0].serviceType,description:s[0].description,serviceImage:s[0].serviceImage||""})),s[0].serviceImage&&S(s[0].serviceImage.toString())):a("/services")}}catch(r){console.error("Error fetching data:",r)}};n=="new"?(E(!0),w({userId:m._id,serviceName:"",serviceType:"",description:"",serviceImage:""})):i()},[n]);const D=(i,r)=>{if(j){async function s(){try{await K({...i,serviceImage:p.toString()})&&(h.push(e.jsx(x,{title:"Service Created",type:"success"}),{placement:"top-center"}),r(!1),a("/services"),setTimeout(()=>{window.location.reload()},500))}catch(t){r(!1),h.push(e.jsx(x,{title:t.message,type:"danger"}),{placement:"top-center"})}}s()}else{async function s(){try{await X({...i,serviceId:n,serviceImage:p.toString()})&&(h.push(e.jsx(x,{title:"Service Edited",type:"success"}),{placement:"top-center"}),r(!1),a("/services"),setTimeout(()=>{window.location.reload()},500))}catch(t){h.push(e.jsx(x,{title:t.message,type:"danger"}),{placement:"top-center"}),r(!1)}}s()}},P=i=>{const r=i.target.files[0];if(r&&r.type==="image/svg+xml"){if(r.size>307200){alert("Please upload a file smaller than 100KB.");return}const t=new FileReader;t.onload=y=>{var l;if((l=y.target)!=null&&l.result){const o=y.target.result,N=new DOMParser().parseFromString(o,"image/svg+xml").documentElement,I=N.getAttribute("width"),C=N.getAttribute("height");console.log(I+" , "+C),parseInt(I)<=300&&parseInt(C)<=175?S(o):alert("Please upload a valid SVG file with dimensions 300 x 175 pixels.")}},t.readAsText(r)}else alert("Please upload a valid SVG file.")};return e.jsxs("main",{className:"w-100 h-full flex flex-col",children:[j&&e.jsx("h1",{children:"Create Service"})||e.jsx("h1",{children:"Edit Service"}),e.jsx($,{enableReinitialize:!0,initialValues:A,validationSchema:Q,onSubmit:(i,{setSubmitting:r})=>{r(!0),setTimeout(()=>{D(i,r)},1e3)},children:({values:i,touched:r,errors:s,isSubmitting:t,resetForm:y})=>{const l={touched:r,errors:s};return e.jsx(H,{children:e.jsxs(M,{children:[e.jsx(g,{name:"serviceName",label:"Service Name :",...l,children:e.jsx(f,{type:"text",autoComplete:"off",name:"serviceName",placeholder:"service name...",component:T})}),e.jsx(g,{name:"serviceType",label:"Service Type :",...l,children:e.jsx(f,{name:"serviceType",children:({field:o,form:d})=>e.jsx(R,{field:o,placeholder:"Select Service Type",form:d,options:F,components:{Option:W,Control:J},value:F.filter(c=>c.value===(i==null?void 0:i.serviceType)),onChange:c=>d.setFieldValue(o.name,c==null?void 0:c.value)})})}),e.jsx(g,{name:"description",label:"Service Description :",...l,children:e.jsx(f,{textArea:!0,type:"text",autoComplete:"off",name:"description",placeholder:"service description...",component:T})}),e.jsx(g,{name:"serviceImage",label:"Service Image :",...l,children:e.jsxs("div",{className:`flex w-full items-center ${p&&"justify-around"||"gap-10"}`,children:[e.jsx(f,{name:"serviceImage",children:({field:o,form:d})=>{const c=o.value?{src:o.value}:{};return e.jsx(G,{className:"cursor-pointer",showList:!1,uploadLimit:1,accept:".svg",onChange:P,children:!p&&e.jsx(z,{className:"border-2 border-white dark:border-gray-800 shadow-lg",size:60,shape:"circle",icon:e.jsx(L,{}),...c})||e.jsx("div",{dangerouslySetInnerHTML:{__html:p},style:{width:"300px",height:"175px"},className:"card-header-svg"})})}}),e.jsxs("p",{children:[e.jsx("strong",{children:"image Upload Requirements:"}),e.jsx("br",{}),e.jsx("strong",{children:"Format:"})," SVG ",e.jsx("br",{}),e.jsx("strong",{children:"Size:"})," 300x175 pixels Maximum",e.jsx("br",{}),e.jsx("strong",{children:"file size:"})," 300 KB"]})]})}),e.jsx("div",{className:"mt-4 ltr:text-right",children:j&&e.jsx(b,{variant:"solid",loading:t,type:"submit",children:t?"Creating":"Create"})||e.jsx(b,{variant:"solid",loading:t,type:"submit",children:t?"Editing":"Edit"})})]})})}})]})},qe=Y;export{qe as default};
