import{r as u,j as e,u as b,a as j,z as N,A as g}from"./index-bf8a941f.js";import{x as y,y as w}from"./index.esm-4fe97196.js";import{d as k,b as C,a as D}from"./NotificationService-d9ca097f.js";import{f as A}from"./Card-82839b3d.js";import"./Card-24bc2910.js";import"./Alert-1d842e79.js";import"./StatusIcon-0225b6e9.js";import"./CloseButton-d50c43fd.js";import"./motion-23928477.js";import"./Tag-338a2893.js";import"./usePopper-113fdeb0.js";import"./index-a2b882c4.js";import"./index-2e58d6d9.js";import"./Badge-b1f0ab32.js";import"./Button-0f33c8fd.js";import"./context-3c7bf7d8.js";import"./index-6975cd84.js";import"./useControllableState-1a7323ea.js";import"./Input-9402e44f.js";import"./Views-4bab5f03.js";import"./get-9e555ae1.js";import"./_MapCache-72043566.js";import"./index-754123b4.js";import"./index-9cb1fb6e.js";import"./cloneDeep-93156ba4.js";import"./Skeleton-67f3ebea.js";import"./index-13a8329a.js";import"./Switcher-2f2e5a73.js";import"./index-8128ce47.js";import"./toast-c77230e6.js";import"./index-0a71f11b.js";import"./FormContainer-7c6e47ec.js";import"./index-6728dd01.js";import"./Select-d53c46ac.js";import"./index-de79736a.js";import"./index-18669cea.js";import"./Upload-cf8abc1c.js";import"./ServiceAPI-25e2710b.js";import"./RichTextEditor-3ec4d100.js";import"./index-346a9733.js";import"./SegmentItemOption-48394355.js";import"./useThemeClass-81aec1c2.js";import"./SvgIcon-51ef36c9.js";import"./ImageWithFallBack-a6a1ee24.js";const S=({children:x,itemsPerPage:n=10,className:d})=>{const[r,p]=u.useState(1),i=Math.ceil(x.length/n),o=a=>{p(a)},m=()=>{r>1&&p(r-1)},h=()=>{r<i&&p(r+1)},t=()=>{const a=[];if(i<=5)for(let s=1;s<=i;s++)a.push(e.jsx("button",{onClick:()=>o(s),disabled:s===r,className:`px-2 py-1 mx-1 border text-white rounded ${s===r?"bg-gray-300 !text-black":""}`,children:s},s));else if(r<=3){for(let s=1;s<=Math.min(3,i);s++)a.push(e.jsx("button",{onClick:()=>o(s),disabled:s===r,className:`px-2 py-1 mx-1 border text-white rounded ${s===r?"bg-gray-300 !text-black":""}`,children:s},s));i>4&&(a.push(e.jsx("span",{className:"px-2 py-1 mx-1",children:"..."},"ellipsis1")),a.push(e.jsx("button",{onClick:()=>o(i-1),className:"px-2 py-1 mx-1 text-white border rounded",children:i-1},i-1)),a.push(e.jsx("button",{onClick:()=>o(i),className:"px-2 py-1 mx-1 text-white border rounded",children:i},i)))}else if(r>=i-2){a.push(e.jsx("button",{onClick:()=>o(1),className:"px-2 py-1 mx-1 text-white border rounded",children:"1"},1)),a.push(e.jsx("button",{onClick:()=>o(2),className:"px-2 py-1 mx-1 text-white border rounded",children:"2"},2)),a.push(e.jsx("span",{className:"px-2 py-1 mx-1",children:"..."},"ellipsis2"));for(let s=i-2;s<=i;s++)a.push(e.jsx("button",{onClick:()=>o(s),disabled:s===r,className:`px-2 py-1 mx-1 text-white border rounded ${s===r?"bg-gray-300 !text-black":""}`,children:s},s))}else{a.push(e.jsx("button",{onClick:()=>o(1),className:"px-2 py-1 mx-1 text-white border rounded",children:"1"},1)),a.push(e.jsx("span",{className:"px-2 py-1 mx-1",children:"..."},"ellipsis1"));for(let s=r-1;s<=r+1;s++)a.push(e.jsx("button",{onClick:()=>o(s),disabled:s===r,className:`px-2 py-1 mx-1 text-white border rounded ${s===r?"bg-gray-300 !text-black":""}`,children:s},s));a.push(e.jsx("span",{className:"px-2 py-1 mx-1",children:"..."},"ellipsis2")),a.push(e.jsx("button",{onClick:()=>o(i-1),className:"px-2 py-1 mx-1 text-white border rounded",children:i-1},i-1)),a.push(e.jsx("button",{onClick:()=>o(i),className:"px-2 py-1 mx-1 text-white border rounded",children:i},i))}return e.jsxs("div",{className:"flex justify-center mt-4",children:[e.jsx("button",{onClick:m,disabled:r===1,className:"px-2 py-1 mx-1 border rounded",children:e.jsx(y,{})}),a,e.jsx("button",{onClick:h,disabled:r===i,className:"px-2 py-1 mx-1 border rounded",children:e.jsx(w,{})})]})},c=(r-1)*n,l=x.slice(c,c+n);return e.jsxs("div",{children:[e.jsx("div",{className:`${d}`,children:l}),t()]})},$=S,v=(x,...n)=>{const[d,r]=u.useState(null),[p,i]=u.useState(!0),[o,m]=u.useState(null);return u.useEffect(()=>{(async()=>{i(!0),m(null);try{const t=await x(...n);r(t)}catch(t){m(t)}finally{i(!1)}})()},[x,...n]),{data:d,loading:p,error:o}},f=v;function ge(){const{_id:x}=b(t=>t.auth.user),{data:n}=f(k,x),{data:d}=f(C),[r,p]=u.useState([]),{unreadNotifs:i,readedNotifs:o}=b(t=>t.locale),m=j();u.useEffect(()=>{var c,l;let t=[...((c=n==null?void 0:n.data)==null?void 0:c.data)||[],...((l=d==null?void 0:d.data)==null?void 0:l.data)||[]];t=t==null?void 0:t.map(a=>(o==null||o.map(s=>{a._id.toString()===s.toString()&&(a.read=!0)}),a)),p(t)},[n,d]);async function h(t){if(console.log(o),!t.read){if(t.public===!1)await D([t._id]);else{let l=[...o];l.push(t._id),m(N(l))}const c=r==null?void 0:r.map(l=>l._id===t._id?{...l,read:!0}:l);p(c),m(g(c.filter(l=>!l.read).length))}}return e.jsxs("main",{className:"w-full flex flex-col",children:[e.jsx("h3",{className:"mb-6",children:"My Notifications"}),r!==void 0&&e.jsx($,{className:"flex flex-col gap-4",itemsPerPage:10,children:r.sort((t,c)=>new Date(c.insertDate).getTime()-new Date(t.insertDate).getTime()).map((t,c)=>{const l=t.read==!1;return e.jsxs("div",{onClick:()=>h(t),className:`flex flex-col w-full gap-1 p-4 border-4 ${l&&"hover:shadow-2xl cursor-pointer border-[red]"||"border-[#374151]"} rounded-xl`,children:[e.jsx("h4",{className:"text-[1.3rem]",children:t.title}),e.jsxs("p",{className:"text-[1rem]",children:[e.jsx("strong",{children:"message:"})," ",e.jsx("span",{className:`${l&&"text-white"}`,children:t.message})]}),e.jsxs("p",{className:"text-[1rem]",children:[e.jsx("strong",{children:"to:"})," ",(t==null?void 0:t.expiryDate)&&"Public"||"You"]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Date:"})," ",A(t.insertDate)]})]},t._id)})})]})}export{ge as default};
