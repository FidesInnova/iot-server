import{j as e,r as i,a as L,u as q,a9 as $,w as B,x as J}from"./index-bf8a941f.js";import{I as b}from"./Input-9402e44f.js";import{A as I}from"./Tag-338a2893.js";import{U as _}from"./Upload-cf8abc1c.js";import{B as w}from"./Button-0f33c8fd.js";import{t as K,N as X}from"./toast-c77230e6.js";import{F as Q}from"./FormContainer-7c6e47ec.js";import{F as V}from"./FormDesription-3c4296f2.js";import{F as u}from"./FormRow-31162199.js";import{c as W,a as N,F as Y,b as ee,d as f}from"./index.esm-510ed08c.js";import{M as k,N as ae,D as te,O as se,P as oe,Q as re,R as le,d as ie}from"./index.esm-4fe97196.js";import{a as ne,c as me}from"./UserApi-a54a968c.js";import{a as ce}from"./MediaAPI-e2a7ad99.js";import"./Card-24bc2910.js";import"./Badge-b1f0ab32.js";import"./RichTextEditor-3ec4d100.js";import{D as z}from"./Skeleton-67f3ebea.js";import"./Views-4bab5f03.js";import"./ServiceAPI-25e2710b.js";import"./SegmentItemOption-48394355.js";import"./SvgIcon-51ef36c9.js";import"./Alert-1d842e79.js";import"./index-6975cd84.js";import"./index-9cb1fb6e.js";import"./Switcher-2f2e5a73.js";import"./index-8128ce47.js";import"./index-754123b4.js";import"./index-6728dd01.js";import{S as de}from"./Select-d53c46ac.js";import"./index-de79736a.js";import"./index-18669cea.js";import"./index-0a71f11b.js";import{T as pe}from"./TimezoneSelector-d7a3257f.js";import{c as ue}from"./countrys-06199e16.js";import"./context-3c7bf7d8.js";import"./get-9e555ae1.js";import"./_MapCache-72043566.js";import"./motion-23928477.js";import"./usePopper-113fdeb0.js";import"./index-a2b882c4.js";import"./index-2e58d6d9.js";import"./cloneDeep-93156ba4.js";import"./CloseButton-d50c43fd.js";import"./StatusIcon-0225b6e9.js";import"./index-346a9733.js";import"./index-13a8329a.js";import"./useThemeClass-81aec1c2.js";import"./useControllableState-1a7323ea.js";function xe({state:n,onClose:r,closable:l=!0,setImageSrc:m}){const c=[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20];return e.jsxs(z,{contentClassName:"w-2/3 h-1/3 flex flex-col gap-6",isOpen:n,onClose:()=>r(!1),closable:l,children:[e.jsx("h4",{children:"Server Images"}),e.jsx("section",{className:"flex flex-wrap gap-6",children:c.map((d,y)=>{const v=`https://developer.fidesinnova.io/app/uploads/avatars/${d}.png`;function C(){m(v),r(!0)}return e.jsx(I,{onClick:C,className:"!w-[100px] !h-[100px] overflow-hidden cursor-pointer hover:border-4 border-sky-500",alt:"icon image",shape:"circle",icon:e.jsx("img",{className:"!w-[100px] !h-[100px] object-contain",src:v},y)})})})]})}function he(n){return n.map(r=>({label:`(${r.code}) ${r.name}`,value:r.code}))}const fe=he(ue),ge=({state:n,setState:r})=>{const l=c=>{r(d=>({...d,countryCode:c}))},m=c=>{r(d=>({...d,phoneNumber:c.target.value}))};return e.jsxs("form",{className:"w-full flex gap-5 mx-auto",children:[e.jsxs("div",{className:"w-4/12 mb-4",children:[e.jsx("label",{htmlFor:"countryCode",className:"block text-sm font-medium",children:"Country Code:"}),e.jsx(de,{id:"countryCode",value:n.countryCode,onChange:l,options:fe,className:"mt-1"})]}),e.jsxs("div",{className:"w-8/12 mb-4",children:[e.jsx("label",{htmlFor:"phoneNumber",className:"block text-sm font-medium",children:"Number:"}),e.jsx(b,{type:"number",id:"phoneNumber",placeholder:"Enter your tel number",value:n.phoneNumber,onChange:m,className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm"})]})]})},je=W().shape({firstName:N().notRequired().min(0,"Too Short!").max(20,"Too Long!"),lastName:N().notRequired().min(0,"Too Short!").max(20,"Too Long!"),email:N().email("Invalid email").required("Email Required"),walletAddress:N().notRequired(),avatar:N().notRequired()}),ua=({})=>{const[n,r]=i.useState({}),[l,m]=i.useState(""),[c,d]=i.useState(""),[y,v]=i.useState(!0),[C,x]=i.useState(!1),[E,S]=i.useState(!1),[P,A]=i.useState(),[D,U]=i.useState({phoneNumber:"",countryCode:null}),R=L();i.useEffect(()=>{async function t(){const a=await ne();r(a.data.data),U(a.data.data.tel||{phoneNumber:"",countryCode:null}),a.data.data.timezone&&(console.log(a.data.data.timezone),A({label:a.data.data.timezone,value:a.data.data.timezone})),m(a.data.data.avatar),v(!1)}t()},[]);const{_id:F}=q(t=>t.auth.user),T=async(t,a)=>{var h,s,j,p;const g=new FormData;g.append("file",c);const o=c?await ce("profile",g):"";R(B(((s=(h=o==null?void 0:o.data)==null?void 0:h.data)==null?void 0:s.url)||l)),R(J(t.firstName)),me((F==null?void 0:F.toString())||"",{...t,avatar:((p=(j=o==null?void 0:o.data)==null?void 0:j.data)==null?void 0:p.url)||l,tel:D,timezone:P.value}),K.push(e.jsx(X,{title:"Profile updated",type:"success"}),{placement:"top-center"}),a(!1)},H=t=>{const a=t.target.files[0];if(a&&(a.type==="image/png"||a.type==="image/jpeg"||a.type==="image/jpg")){if(a.size>512e3){alert("Please upload a file smaller than 500KB.");return}const o=new FileReader;o.onload=h=>{var s;if((s=h.target)!=null&&s.result){const j=h.target.result,p=new Image;p.src=j,p.onload=()=>{const O=p.width,Z=p.height;O<=200&&Z<=200?(d(a),m(j),x(!1)):alert("Please upload a valid image file with dimensions 200 x 200 pixels.")}}},o.readAsDataURL(a)}else alert("Please upload a valid ( PNG, JPEG, JPG ) file.")};function M(){d(""),m("")}function G(t){t?(x(!1),S(!1)):(x(!0),S(!1))}return e.jsx(Y,{enableReinitialize:!0,initialValues:n,validationSchema:je,onSubmit:(t,{setSubmitting:a})=>{a(!0),setTimeout(()=>{T(t,a)},1e3)},children:({values:t,touched:a,errors:g,isSubmitting:o,resetForm:h})=>{const s={touched:a,errors:g};return e.jsx(ee,{children:y===!1&&e.jsxs(Q,{children:[e.jsx(V,{title:"General",desc:"Basic info, like your name and avatar that will displayed in public"}),e.jsx(u,{name:"firstName",label:"First Name",...s,children:e.jsx(f,{type:"text",autoComplete:"off",name:"firstName",placeholder:"first name",component:b,prefix:e.jsx(k,{className:"text-xl"})})}),e.jsx(u,{name:"lastName",label:"Last Name",...s,children:e.jsx(f,{type:"text",autoComplete:"off",name:"lastName",placeholder:"last name",component:b,prefix:e.jsx(k,{className:"text-xl"})})}),e.jsx(u,{name:"email",label:"Email",...s,children:e.jsx(f,{type:"email",autoComplete:"off",name:"email",placeholder:"Email",component:b,prefix:e.jsx(ae,{className:"text-xl"})})}),e.jsx(u,{name:"tel",label:"Tel",...s,children:e.jsx(f,{name:"tel",state:D,setState:U,component:ge,prefix:e.jsx(te,{className:"text-xl"})})}),e.jsx(u,{name:"walletAddress",label:"Wallet Address",...s,children:e.jsx(f,{type:"text",autoComplete:"off",name:"walletAddress",placeholder:"wallet address",component:b,prefix:e.jsx(se,{className:"text-xl"})})}),e.jsx(u,{name:"timeZone",label:"Time Zone",...s,children:e.jsx(f,{readOnly:!0,type:"text",autoComplete:"off",name:"timeZone",placeholder:"Time Zone",component:pe,selectedTimeZone:P,setSelectedTimeZone:A,prefix:e.jsx(oe,{className:"text-xl"})})}),e.jsx(u,{name:"avatar",label:"Avatar",...s,children:e.jsxs("div",{className:"flex w-full justify-around items-center",children:[e.jsxs(z,{isOpen:C,onClose:()=>x(!1),contentClassName:"w-1/3 h-1/3",closable:!0,children:[e.jsx("h4",{className:"mb-8",children:"Select Image"}),e.jsxs("div",{className:"flex mx-auto w-2/3 justify-between",children:[e.jsx(_,{className:"cursor-pointer",showList:!1,uploadLimit:1,accept:".png, .jpg, .jpeg",onChange:H,children:e.jsxs(w,{className:"flex items-center gap-2",children:["Upload"," ",e.jsx(re,{className:"text-[1.2rem]"})]})}),e.jsxs(w,{onClick:()=>{x(!1),S(!0)},className:"flex items-center gap-2",children:["Select"," ",e.jsx(le,{className:"text-[1.2rem]"})]})]}),e.jsx("div",{className:"flex mt-4 mx-auto w-2/3 justify-between",children:e.jsxs("p",{children:[e.jsx("strong",{children:"Image Upload Requirements:"}),e.jsx("br",{}),e.jsx("strong",{children:"Format:"})," ","PNG, JPEG, JPG ",e.jsx("br",{}),e.jsx("strong",{children:"Size:"})," ","200x200 pixels Maximum",e.jsx("br",{}),e.jsx("strong",{children:"File size:"})," ","500 KB"]})})]}),e.jsx(xe,{setImageSrc:m,onClose:G,state:E}),e.jsx("section",{className:"cursor-pointer",onClick:()=>x(!0),children:!l&&e.jsx(I,{className:"!w-[100px] !h-[100px] border-2 border-white dark:border-gray-800 shadow-lg",size:60,shape:"circle",icon:e.jsx(ie,{className:"text-5xl"})})||e.jsx(I,{className:"!w-[100px] !h-[100px] overflow-hidden border-2 border-white dark:border-gray-800 shadow-lg",size:60,shape:"circle",icon:e.jsx("img",{src:l,alt:"Uploaded Service Image",style:{objectFit:"cover",width:"100px !important",height:"100px !important"}})})}),e.jsx(w,{onClick:M,type:"button",variant:"solid",color:"red",size:"md",disabled:!l&&!0||!1,children:"Remove Image"})]})}),e.jsx("div",{className:"mt-4 ltr:text-right",children:e.jsx(w,{variant:"solid",loading:o,type:"submit",children:o?"Updating":"Update"})})]})||e.jsx("div",{className:"w-full h-[60dvh]",children:e.jsx($,{loading:!0})})})}})};export{ua as default};
