import{_ as ae}from"./Select-d53c46ac.js";import{r as u,_ as se,l as ne,m as re,n as ie,o as oe,p as ce,q as J,j as e,c as S,H as le,t as de,u as b,h as ue,N as fe,f as pe,a as Q,v as me,g as he,w as ge,x as xe,y as ve,z as D,A as B,B as je}from"./index-bf8a941f.js";import"./Alert-1d842e79.js";import{A as W,T as ye}from"./Tag-338a2893.js";import{B as X}from"./Badge-b1f0ab32.js";import{B as Z}from"./Button-0f33c8fd.js";import"./index-6975cd84.js";import"./Card-24bc2910.js";import"./index-9cb1fb6e.js";import"./Skeleton-67f3ebea.js";import{D as Ne}from"./Switcher-2f2e5a73.js";import{D as C,S as be}from"./index-8128ce47.js";import"./FormContainer-7c6e47ec.js";import"./Input-9402e44f.js";import"./index-754123b4.js";import"./toast-c77230e6.js";import"./index-6728dd01.js";import"./index-de79736a.js";import"./index-18669cea.js";import"./index-0a71f11b.js";import"./Upload-cf8abc1c.js";import{w as z}from"./SidePanel-f07e57d5.js";import{b as we,c as Ce,d as K,e as Se,f as ke,g as Oe,h as Ie,i as Ee,j as Ae,k as Te,l as Me,m as _e,n as Le,o as Pe,p as De,q as F}from"./index.esm-4fe97196.js";import{a as He}from"./UserApi-a54a968c.js";import{u as Re}from"./Views-4bab5f03.js";import{i as Ue}from"./isLastChild-83eb4c23.js";import{u as ze}from"./useThemeClass-81aec1c2.js";import{a as $,b as Be,c as We}from"./NotificationService-d9ca097f.js";import{f as Ke}from"./Card-82839b3d.js";function Fe(){if(console&&console.warn){for(var s,t=arguments.length,a=new Array(t),r=0;r<t;r++)a[r]=arguments[r];typeof a[0]=="string"&&(a[0]="react-i18next:: ".concat(a[0])),(s=console).warn.apply(s,a)}}var V={};function U(){for(var s=arguments.length,t=new Array(s),a=0;a<s;a++)t[a]=arguments[a];typeof t[0]=="string"&&V[t[0]]||(typeof t[0]=="string"&&(V[t[0]]=new Date),Fe.apply(void 0,t))}var ee=function(t,a){return function(){if(t.isInitialized)a();else{var r=function o(){setTimeout(function(){t.off("initialized",o)},0),a()};t.on("initialized",r)}}};function G(s,t,a){s.loadNamespaces(t,ee(s,a))}function Y(s,t,a,r){typeof a=="string"&&(a=[a]),a.forEach(function(o){s.options.ns.indexOf(o)<0&&s.options.ns.push(o)}),s.loadLanguages(t,ee(s,r))}function $e(s,t){var a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},r=t.languages[0],o=t.options?t.options.fallbackLng:!1,m=t.languages[t.languages.length-1];if(r.toLowerCase()==="cimode")return!0;var n=function(h,N){var w=t.services.backendConnector.state["".concat(h,"|").concat(N)];return w===-1||w===2};return a.bindI18n&&a.bindI18n.indexOf("languageChanging")>-1&&t.services.backendConnector.backend&&t.isLanguageChangingTo&&!n(t.isLanguageChangingTo,s)?!1:!!(t.hasResourceBundle(r,s)||!t.services.backendConnector.backend||t.options.resources&&!t.options.partialBundledLanguages||n(r,s)&&(!o||n(m,s)))}function Ve(s,t){var a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};if(!t.languages||!t.languages.length)return U("i18n.languages were undefined or empty",t.languages),!0;var r=t.options.ignoreJSONStructure!==void 0;return r?t.hasLoadedNamespace(s,{lng:a.lng,precheck:function(m,n){if(a.bindI18n&&a.bindI18n.indexOf("languageChanging")>-1&&m.services.backendConnector.backend&&m.isLanguageChangingTo&&!n(m.isLanguageChangingTo,s))return!1}}):$e(s,t,a)}var Ge=u.createContext(),Ye=function(){function s(){ne(this,s),this.usedNamespaces={}}return se(s,[{key:"addUsedNamespaces",value:function(a){var r=this;a.forEach(function(o){r.usedNamespaces[o]||(r.usedNamespaces[o]=!0)})}},{key:"getUsedNamespaces",value:function(){return Object.keys(this.usedNamespaces)}}]),s}();function q(s,t){var a=Object.keys(s);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(s);t&&(r=r.filter(function(o){return Object.getOwnPropertyDescriptor(s,o).enumerable})),a.push.apply(a,r)}return a}function H(s){for(var t=1;t<arguments.length;t++){var a=arguments[t]!=null?arguments[t]:{};t%2?q(Object(a),!0).forEach(function(r){ie(s,r,a[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(s,Object.getOwnPropertyDescriptors(a)):q(Object(a)).forEach(function(r){Object.defineProperty(s,r,Object.getOwnPropertyDescriptor(a,r))})}return s}var qe=function(t,a){var r=u.useRef();return u.useEffect(function(){r.current=a?r.current:t},[t,a]),r.current};function Lt(s){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},a=t.i18n,r=u.useContext(Ge)||{},o=r.i18n,m=r.defaultNS,n=a||o||oe();if(n&&!n.reportNamespaces&&(n.reportNamespaces=new Ye),!n){U("You will need to pass in an i18next instance by using initReactI18next");var y=function(j,c){return typeof c=="string"?c:c&&ce(c)==="object"&&typeof c.defaultValue=="string"?c.defaultValue:Array.isArray(j)?j[j.length-1]:j},h=[y,{},!1];return h.t=y,h.i18n={},h.ready=!1,h}n.options.react&&n.options.react.wait!==void 0&&U("It seems you are still using the old wait option, you may migrate to the new useSuspense behaviour.");var N=H(H(H({},re()),n.options.react),t),w=N.useSuspense,x=N.keyPrefix,p=s||m||n.options&&n.options.defaultNS;p=typeof p=="string"?[p]:p||["translation"],n.reportNamespaces.addUsedNamespaces&&n.reportNamespaces.addUsedNamespaces(p);var g=(n.isInitialized||n.initializedStoreOnce)&&p.every(function(d){return Ve(d,n,N)});function l(){return n.getFixedT(t.lng||null,N.nsMode==="fallback"?p:p[0],x)}var P=u.useState(l),M=ae(P,2),_=M[0],k=M[1],O=p.join();t.lng&&(O="".concat(t.lng).concat(O));var L=qe(O),i=u.useRef(!0);u.useEffect(function(){var d=N.bindI18n,j=N.bindI18nStore;i.current=!0,!g&&!w&&(t.lng?Y(n,t.lng,p,function(){i.current&&k(l)}):G(n,p,function(){i.current&&k(l)})),g&&L&&L!==O&&i.current&&k(l);function c(){i.current&&k(l)}return d&&n&&n.on(d,c),j&&n&&n.store.on(j,c),function(){i.current=!1,d&&n&&d.split(" ").forEach(function(A){return n.off(A,c)}),j&&n&&j.split(" ").forEach(function(A){return n.store.off(A,c)})}},[n,O]);var v=u.useRef(!0);u.useEffect(function(){i.current&&!v.current&&k(l),v.current=!1},[n,x]);var f=[_,n,g];if(f.t=_,f.i18n=n,f.ready=g,g||!g&&!w)return f;throw new Promise(function(d){t.lng?Y(n,t.lng,p,function(){return d()}):G(n,p,function(){return d()})})}const Pt=s=>{const{headerStart:t,headerEnd:a,headerMiddle:r,className:o,container:m}=s,n=J(),y=()=>{n("/services/new")};return e.jsx("header",{className:S("header",o),children:e.jsxs("div",{className:S("header-wrapper",le,m&&"container mx-auto"),children:[e.jsx("div",{className:"header-action header-action-start",children:t}),r&&e.jsx("div",{className:"header-action header-action-middle",children:r}),e.jsxs("div",{className:"flex flex-row",children:[e.jsxs("div",{className:"flex mt-1 justify-end",children:[" ",e.jsx(Z,{onClick:y,variant:"solid",children:"Create New Service"})," "]}),e.jsx("div",{className:"header-action header-action-end",children:a})]})]})})},I={xs:"576",sm:"640px",md:"768px",lg:"1024px",xl:"1280px","2xl":"1536px"},E=(s="")=>parseInt(s.replace("px","")),Je={"2xl":E(I["2xl"]),xl:E(I.xl),lg:E(I.lg),md:E(I.md),sm:E(I.sm),xs:E(I.xs)},te=()=>{const s=(m="smaller")=>{const n=window.innerWidth;return Object.fromEntries(Object.entries(Je).map(([y,h])=>[y,m==="larger"?n>h:n<h]))},t=()=>({windowWidth:window.innerWidth,larger:s("larger"),smaller:s("smaller")}),[a,r]=u.useState(t()),o=()=>{const m=t();r(m)};return u.useEffect(()=>(window.addEventListener("resize",o),()=>window.removeEventListener("resize",o)),[a.windowWidth]),a},Qe=({toggled:s,className:t})=>e.jsx("div",{className:t,children:s?e.jsx(we,{}):e.jsx(Ce,{})}),Dt="title",Ht="collapse",T="item",Xe=[{key:"dashboard",path:"/dashboard",title:"Dashboard",translateKey:"nav.dashboard",icon:"home",type:T,authority:[],subMenu:[]},{key:"devices",path:"/devices",title:"Device List",translateKey:"nav.devices",icon:"list",type:T,authority:[],subMenu:[]},{key:"services",path:"/services",title:"My Services",translateKey:"nav.services",icon:"myService",type:T,authority:[],subMenu:[]},{key:"installed",path:"/installed",title:"Installed Services",translateKey:"nav.installed",icon:"download",type:T,authority:[],subMenu:[]},{key:"market",path:"/market",title:"Service Market",translateKey:"nav.market",icon:"singleMenu",type:T,authority:[],subMenu:[]}],Ze=u.lazy(()=>de(()=>import("./index-26287f33.js"),["assets/index-26287f33.js","assets/VerticalMenuContent-8d672e06.js","assets/index-bf8a941f.js","assets/index-4cfd9622.css","assets/index-754123b4.js","assets/index.esm-4fe97196.js","assets/motion-23928477.js","assets/Tag-338a2893.js","assets/usePopper-113fdeb0.js","assets/index-a2b882c4.js","assets/index-2e58d6d9.js","assets/Select-d53c46ac.js","assets/Views-4bab5f03.js","assets/get-9e555ae1.js","assets/_MapCache-72043566.js","assets/context-3c7bf7d8.js","assets/index-8128ce47.js","assets/Input-9402e44f.js","assets/toast-c77230e6.js","assets/StatusIcon-0225b6e9.js","assets/CloseButton-d50c43fd.js","assets/index-6975cd84.js","assets/useControllableState-1a7323ea.js","assets/Button-0f33c8fd.js","assets/index-0a71f11b.js","assets/isPlainObject-7f2e0dea.js","assets/cloneDeep-93156ba4.js","assets/Alert-1d842e79.js","assets/Badge-b1f0ab32.js","assets/Card-24bc2910.js","assets/index-9cb1fb6e.js","assets/Skeleton-67f3ebea.js","assets/index-13a8329a.js","assets/Switcher-2f2e5a73.js","assets/FormContainer-7c6e47ec.js","assets/index-6728dd01.js","assets/index-de79736a.js","assets/index-18669cea.js","assets/Upload-cf8abc1c.js","assets/SidePanel-f07e57d5.js","assets/SegmentItemOption-48394355.js","assets/useThemeClass-81aec1c2.js","assets/DoubleSidedImage-5799e7a3.js","assets/UserApi-a54a968c.js","assets/isLastChild-83eb4c23.js","assets/NotificationService-d9ca097f.js","assets/Card-82839b3d.js","assets/ServiceAPI-25e2710b.js","assets/RichTextEditor-3ec4d100.js","assets/index-346a9733.js","assets/RichTextEditor-8e59e50e.css","assets/SvgIcon-51ef36c9.js","assets/ImageWithFallBack-a6a1ee24.js","assets/Card-c44f1152.css"])),et=z(Qe),Rt=()=>{const[s,t]=u.useState(!1),a=()=>{t(!0)},r=()=>{t(!1)},o=b(l=>l.theme.themeColor),m=b(l=>l.theme.primaryColorLevel),n=b(l=>l.theme.navMode),y=b(l=>l.theme.mode),h=b(l=>l.theme.direction),N=b(l=>l.base.common.currentRouteKey),w=b(l=>l.theme.layout.sideNavCollapse),x=b(l=>l.auth.user.authority),{smaller:p}=te(),g=()=>n===fe?`bg-${o}-${m} side-nav-${n}`:n===pe?`side-nav-${y}`:`side-nav-${n}`;return e.jsx(e.Fragment,{children:p.md&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"text-2xl",onClick:a,children:e.jsx(et,{toggled:s})}),e.jsx(Ne,{title:"Navigation",isOpen:s,bodyClass:S(g(),"p-0"),width:330,placement:h===ue?"right":"left",onClose:r,onRequestClose:r,children:e.jsx(u.Suspense,{fallback:e.jsx(e.Fragment,{}),children:s&&e.jsx(Ze,{navMode:n,collapsed:w,navigationTree:Xe,routeKey:N,userAuthority:x,direction:h,onMenuItemClick:r})})})]})})},tt=[{label:"Account Setting",path:"/account/settings/profile",icon:e.jsx(ke,{})}],at=({className:s})=>{const[t,a]=u.useState(""),{userName:r,authority:o,email:m}=b(x=>x.auth.user),{avatarLink:n,firstName:y}=b(x=>x.locale),h=Q();u.useEffect(()=>{async function x(){const p=await He();a(p.data.data),h(ge(p.data.data.avatar)),h(xe(p.data.data.firstName))}x()},[]);const{signOut:N}=me(),w=e.jsxs("div",{className:S(s,"flex items-center gap-2"),children:[e.jsx(W,{className:"overflow-hidden",size:32,shape:"circle",icon:n&&e.jsx("img",{src:n})||e.jsx(K,{})}),e.jsxs("div",{className:"hidden md:block",children:[e.jsx("div",{className:"text-xs capitalize",children:(o==null?void 0:o[0])||""}),e.jsx("div",{className:"font-bold",children:y||""})]})]});return e.jsx("div",{children:e.jsxs(C,{menuStyle:{minWidth:240},renderTitle:w,placement:"bottom-end",children:[e.jsx(C.Item,{variant:"header",children:e.jsxs("div",{className:"py-2 px-3 flex items-center gap-2",children:[e.jsx(W,{className:"overflow-hidden",size:32,shape:"circle",icon:n&&e.jsx("img",{src:n})||e.jsx(K,{})}),e.jsxs("div",{children:[e.jsx("div",{className:"font-bold text-gray-900 dark:text-gray-100",children:r==null?void 0:r.split("@")[0]}),e.jsx("div",{className:"text-xs",children:m})]})]})}),e.jsx(C.Item,{variant:"divider"}),tt.map(x=>e.jsx(C.Item,{eventKey:x.label,className:"mb-1 px-0",children:e.jsx(he,{className:"flex h-full w-full px-2",to:x.path,children:e.jsxs("span",{className:"flex gap-2 items-center w-full",children:[e.jsx("span",{className:"text-xl opacity-50",children:x.icon}),e.jsx("span",{children:x.label})]})})},x.label)),e.jsxs(C.Item,{eventKey:"Sign Out",className:"gap-2",onClick:N,children:[e.jsx("span",{className:"text-xl opacity-50",children:e.jsx(Se,{})}),e.jsx("span",{children:"Sign Out"})]})]})})},Ut=z(at),zt=s=>{const{userAuthority:t=[],authority:a=[],children:r}=s,o=Re(t,a);return e.jsx(e.Fragment,{children:o?r:null})},Bt={home:e.jsx(Oe,{}),download:e.jsx(Ie,{}),myService:e.jsx(Ee,{}),singleMenu:e.jsx(Ae,{}),documentDownload:e.jsx(Te,{}),list:e.jsx(Me,{}),collapseMenu:e.jsx(_e,{}),groupSingleMenu:e.jsx(Le,{}),groupCollapseMenu:e.jsx(Pe,{})},R="h-72",st=({className:s,dot:t})=>e.jsx("div",{className:S("text-2xl",s),children:t?e.jsx(X,{badgeStyle:{top:"3px",right:"6px"},children:e.jsx(F,{})}):e.jsx(F,{})}),nt=({className:s})=>{const[t,a]=u.useState([]),[r,o]=u.useState(!1),[m,n]=u.useState(!1),[y,h]=u.useState(!0),N=ve(),w=J(),{_id:x}=b(i=>i.auth.user),{unreadNotifs:p,readedNotifs:g}=b(i=>i.locale),l=Q(),{bgTheme:P}=ze(),{larger:M}=te(),_=b(i=>i.theme.direction),k=async()=>{var d,j;h(!0);const i=await Be(),v=await We(x||"");let f=[...(d=v==null?void 0:v.data)==null?void 0:d.data,...(j=i==null?void 0:i.data)==null?void 0:j.data];f=f==null?void 0:f.map(c=>(g==null||g.map(A=>{c._id.toString()===A.toString()&&(c.read=!0)}),c)),f=f.filter(c=>c.read==!1),a(f),l(B(f.filter(c=>!c.read).length)),h(!1),f.filter(c=>!c.read).length>0?(o(!0),n(!1)):(o(!1),n(!0))};u.useEffect(()=>{p==0&&(o(!1),n(!0),a([]))},[p]),u.useEffect(()=>{g===void 0&&l(D([]));let i=t;i=i==null?void 0:i.map(v=>(g==null||g.map(f=>{v._id.toString()===f.toString()&&(v.read=!0)}),v)),a(i)},[g]),u.useEffect(()=>{k()},[N.pathname]);const O=u.useCallback(async()=>{let i=0;const v=t.map(d=>{if(d.read==!0&&(i=i+1),!d.read&&(d.read=!0,d.public==!0)){let j=[...g];j.push(d._id),l(D(j))}return d});a(v);const f=t.filter(d=>d.public===!1).map(d=>d._id);if(h(!0),f.length==i)return h(!1),!1;f.length>0&&await $(f),l(B(0)),h(!1),o(!1)},[t]),L=u.useCallback(i=>{let v=!1,f=!1;const d=t.map(c=>(c._id===i&&(f=c.public,c.read==!0&&(v=!0),c.read=!0),c));if(v==!0)return!1;if(f==!1)$([i]);else{let c=[...g];c.push(i),l(D(c))}a(d),t.some(c=>!c.read)||o(!1)},[t]);return e.jsxs(C,{renderTitle:e.jsx(st,{dot:r,className:s}),menuClass:"p-0 min-w-[280px] md:min-w-[340px]",placement:M.md?"bottom-end":"bottom-center",children:[e.jsx(C.Item,{variant:"header",children:e.jsxs("div",{className:"border-b border-gray-200 dark:border-gray-600 px-4 py-2 flex items-center justify-between",children:[e.jsx("h6",{children:"Notifications"}),e.jsx(ye,{title:"Mark all as read",children:e.jsx(Z,{variant:"plain",shape:"circle",size:"sm",icon:e.jsx(De,{className:"text-xl"}),onClick:O})})]})}),e.jsx("div",{className:S("overflow-y-auto",R),children:e.jsxs(be,{direction:_,children:[t.length>0&&m==!1&&t.map((i,v)=>e.jsxs("div",{className:`relative flex px-4 py-4 cursor-pointer hover:bg-gray-50 active:bg-gray-100 dark:hover:bg-black dark:hover:bg-opacity-20  ${Ue(t,v)?"":"border-b border-gray-200 dark:border-gray-600"}`,onClick:()=>L(i._id),children:[e.jsxs("div",{className:"ltr:ml-3 rtl:mr-3",children:[e.jsxs("div",{className:"flex flex-col",children:[i.userId&&e.jsxs("span",{className:"font-semibold heading-text",children:[i.title," "]}),e.jsx("span",{className:"line-clamp-2",children:i.message})]}),e.jsx("span",{className:"text-xs",children:Ke(i.insertDate.toString())})]}),e.jsx(X,{className:"absolute top-4 ltr:right-4 rtl:left-4 mt-1.5",innerClass:`${i.read?"bg-gray-300":P} `})]},i._id)),y&&e.jsx("div",{className:S("flex items-center justify-center",R),children:e.jsx(je,{size:40})}),m&&!y&&e.jsx("div",{className:S("flex items-center justify-center",R),children:e.jsxs("div",{className:"text-center",children:[e.jsx("img",{className:"mx-auto mb-2 max-w-[150px]",src:"/img/others/no-notification.png",alt:"no-notification"}),e.jsx("h6",{className:"font-semibold",children:"No notifications!"}),e.jsx("p",{className:"mt-1",children:"Please Try again later"})]})})]})}),e.jsx(C.Item,{variant:"header",children:e.jsx("div",{className:"flex justify-center border-t border-gray-200 dark:border-gray-600 px-4 py-2",children:e.jsx("p",{onClick:()=>w("/notifications"),className:"font-semibold cursor-pointer p-2 px-3 text-gray-600 hover:text-gray-900 dark:text-gray-200 dark:hover:text-white",children:"View All Notifications"})})})]})},Wt=z(nt);export{zt as A,Pt as H,Ge as I,Rt as M,Wt as N,Ut as U,Qe as a,T as b,Bt as c,Lt as d,Dt as e,Ht as f,Fe as g,Xe as n,te as u,U as w};
